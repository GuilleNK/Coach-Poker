<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Coach de Poker</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      background: #f5f5f5;
      color: #333;
    }
    h2 {
      margin-bottom: 1rem;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      margin: 0.5rem 0;
    }
    button {
      padding: 0.5rem 1rem;
      border: none;
      background-color: #4caf50;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
    const tree = {
      position: "CO",
      situation: "vs Straddle call, flop dry",
      flop: "8c 4s 2d",
      stack: "100bb",
      in_position: false,
      has_initiative: true,
      action: {
        question: "Flop: 8♣ 4♠ 2♦. Tenés la iniciativa pero estás fuera de posición. ¿Qué hacés?",
        options: {
          "Cbet 1/3 pot": {
            result: "Villano puede foldear, pagar o hacer raise.",
            next: {
              "Fold": "Ganás el bote. Nodo terminal.",
              "Call": {
                turn: "Nodo de turn por definir (según carta)."
              },
              "Raise": {
                response: "¿Qué hacés frente a raise?",
                options: {
                  "Fold": "Nodo terminal. Cedés el bote.",
                  "Call": "Vas al turn con SPR más chico.",
                  "3bet shove": "Agresivo: sólo con top range o semibluffs."
                }
              }
            }
          },
          "Check": {
            result: "Villano puede apostar o chequear. Se pierde iniciativa."
          },
          "Overbet": {
            result: "Línea no estándar. Rara vez usada en este board."
          }
        }
      }
    };

    const app = document.getElementById("app");

    function renderNode(node) {
      app.innerHTML = "";

      const question = document.createElement("h2");
      question.innerText = node.action.question;
      app.appendChild(question);

      const list = document.createElement("ul");

      for (const [option, result] of Object.entries(node.action.options)) {
        const li = document.createElement("li");
        const btn = document.createElement("button");
        btn.innerText = option;
        btn.onclick = () => {
          showResult(result);
        };
        li.appendChild(btn);
        list.appendChild(li);
      }

      app.appendChild(list);
    }

    function showResult(result) {
      app.innerHTML = "";

      if (typeof result === "string") {
        app.innerHTML = `<p>${result}</p><button onclick='renderNode(tree)'>Volver</button>`;
      } else if (result.result) {
        const p = document.createElement("p");
        p.innerText = result.result;
        app.appendChild(p);

        if (result.next) {
          const list = document.createElement("ul");
          for (const [option, outcome] of Object.entries(result.next)) {
            const li = document.createElement("li");
            const btn = document.createElement("button");
            btn.innerText = option;
            btn.onclick = () => showResult(outcome);
            li.appendChild(btn);
            list.appendChild(li);
          }
          app.appendChild(list);
        } else if (result.response && result.options) {
          const q = document.createElement("p");
          q.innerText = result.response;
          app.appendChild(q);

          const list = document.createElement("ul");
          for (const [option, outcome] of Object.entries(result.options)) {
            const li = document.createElement("li");
            const btn = document.createElement("button");
            btn.innerText = option;
            btn.onclick = () => showResult(outcome);
            li.appendChild(btn);
            list.appendChild(li);
          }
          app.appendChild(list);
        }

        const back = document.createElement("button");
        back.innerText = "Volver";
        back.onclick = () => renderNode(tree);
        app.appendChild(back);
      }
    }

    renderNode(tree);
  </script>
</body>
</html>
